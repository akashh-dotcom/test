<?xml version="1.0" encoding="UTF-8"?>

<chapter id="ch0023"><title>Chapter 23 The Role of Numerical Modeling and Simulations to Evaluate Implantable Leads: Implications for MRI Safety</title><para><emphasis role="bold">EUGENIO MATTEI, PH.D., MEDENG.</emphasis></para>
    <para>Researcher</para>
    <para>Department of Cardiovascular, Endocrine-metabolic Diseases and Aging</para>
    <para>Italian National Institute of Health</para>
    <para>Rome, Italy</para>
    <para><emphasis role="bold">FEDERICA CENSI, PH.D., EENG.</emphasis></para>
    <para>Lead Researcher</para>
    <para>Department of Cardiovascular, Endocrine-metabolic Diseases and Aging</para>
    <para>Italian National Institute of Health</para>
    <para>Rome, Italy</para>
    <para><emphasis role="bold">GIOVANNI CALCAGNINI, PH.D., EENG.</emphasis></para>
    <para>Lead Researcher</para>
    <para>Department of Cardiovascular, Endocrine-metabolic Diseases and Aging</para>
    <para>Italian National Institute of Health</para>
    <para>Rome, Italy</para>
      <sect1 id="ch0023s0000s0001">
        <title>INTRODUCTION</title>
    <para>The level of knowledge of a natural phenomenon has often been related to the ability to describe it through more or less complex mathematical relationships. Notably, physicists and engineers have always used mathematical tools and modeling to represent the real world. On the contrary, some biological disciplines, especially in the past, showed more skepticism to their use. It is argued that the biological reality is extremely complex and, therefore, not suitable to be represented by an oversimplified model. This objection implies that the description of a system through mathematical and physical models may produce a distortion of the phenomena under investigation. As such, it is difficult to refute this objection because, as a matter of fact, the construction of any mathematical model needs to formulate simplifying hypotheses. However, this is a characteristic of all cognitive phenomena,</para>
    <para>which are always based on some form of schematization. What is interesting to see is whether the mathematical or physical model is indeed more distorting than other methods. The mere presentation of experimental results does not produce conceptual distortions, but cannot be considered free from defects on a practical level, because even the measurement, in itself, implies an alteration of the system. Moreover, and this is a point of great importance, it does not allow the interpretation of the phenomenon, since its function is purely descriptive. On the other hand, when it is possible to describe a complex phenomenon using the basic laws of physics, it is possible to provide an interpretative key to the results that are obtained (i.e., an interpretative model). On the basis of the model, it is then also possible to formulate predictions on the behavior of the same phenomenon over time, or even under conditions that differ from those observed when experimental data were collected (i.e., a predictive model).</para>
    <para>It is useful to emphasize that the biomedical world has always been very familiar with the concept of model, although it is generally associated with <emphasis role="italics">in vitro</emphasis> studies or animal models. Indeed, experimental medical practice leads from clinical to laboratory experience to return to clinical experience, developing through abstraction and simplification steps, in order to understand the single aspects that contribute to complex natural phenomena. This approach is very similar to that of physical-mathematical modeling: the profound complexity that characterizes living organisms and the countless relationships existing between their different components, make it impossible to describe the system in its entirety and require the identification of specific sub-phenomena, with the introduction of drastically simplified models with respect to reality. However, keeping in mind these simplifications, the models can provide results and interpretations on the physical aspects of biological reality that could hardly be achieved by the observation of experimental evidence alone.</para>
    <para>The definition of a model commonly accepted by methodologists of science is: given any system, S, where system means a set of elements connected to each other, it is said that a new system, M, represents a model of S when it is possible to establish a correspondence between the elements and relationships of S and the elements and relationships of M. Such definition implies that, to a certain extent, the study of the system S can be traced back to the study of the system M. When the elements of M are mathematical entities and the relationships between them are mathematical functions, M is called a mathematical model.</para>
    <para>The definition of a physical model is more debated. In some cases, a physical model is defined as a mathematical model in which the relationships that bind the different elements of the model are borrowed from the language of physics. According to another interpretation, the physical model represents a simplification of the starting model that allows a simpler characterization and evaluation, but always in terms of experimental measurements and not through mathematical functions.</para>
    <para>When it is possible to characterize the structure and properties of a system and write the relationships between the different variables, it is also possible to proceed to the construction of the mathematical model with interpretative function. However, it is evident that when choosing the structure of the model corresponding to the system under consideration, it is necessary to accept some simplification. Thus, the model is generally deduced through a process of abstraction and a series of simplifying hypotheses, which lead the real system</para>
    <para>to be associated to an ideal or "abstract" system that is an image of the former but which it is not the exact replica.</para>
    <para>The adoption of simplifying hypotheses poses the problem of the validation of the model, which is generally based on the comparison between the results obtained from the model, through logical deductions or numerical simulations, and the results obtained from the experimental analysis on the real system. Even when the comparison is successful, it is necessary to ask whether the model is valid only for the particular experiment carried out or has more general validity. In the first case, the model would lose all forecasting capacity. However, even in this case, the model would still have the merit of providing an interpretation of the experimental evidence, which goes far beyond the simple descriptive function.</para>
    <para>When all the hypotheses underlying the model are demonstrated to be valid, the deductive nature of the modeling process reasonably allows the ability to recognize the interpretative (and predictive) capabilities of the model, for a various set of physiological conditions, not necessarily limited to those under which the validation was carried out. The possibility of modifying the structure of the physical/mathematical model that describes a particular biological phenomenon, undoubtedly represents a useful tool towards a form of predictive, preventive, and personal care, which is now becoming the paradigm of modern medicine.</para>
    <para>The general concepts expressed so far fit well with the study of the interactions of electromagnetic fields with biological tissues. In particular, the modelistic approach has represented and continues to be an indispensable means of analysis for the evaluation, both in qualitative but also in quantitative terms, of human exposure to non-ionizing electromagnetic fields. The knowledge of the mechanisms underlying the propagation and the interactions of electromagnetic fields with the external world has always proceeded in parallel with the ability to describe them through mathematical laws. Beginning with the identification of simple relationships, valid only for particular cases and under strong simplifying hypotheses, with the progress of science, increasingly complex models of general validity have been formulated. In some cases, they have also permitted the capability to hypothesize the existence of particular phenomena before being able to have an experimental evidence of the same phenomena. Maxwell's equations constitute the fundamental mathematical model for the description of the electromagnetic phenomenon and give a complete description of the relationships between electromagnetic fields, charges, and current distributions.</para>
    <para>∇ × E = -∂B/∂t                                                                                                                    (1)</para>
    <para>∇ × H = ∂D/∂t + J                                                                                                              (2)</para>
    <para>∇ · D = ρ                                                                                                                           (3)</para>
    <para>∇ · B = 0                                                                                                                           (4)</para>
    <para>E = Electric Field (V/m)</para>
    <para>H = Magnetic Field (A/m)</para>
    <para>D = Electric induction (C/m<superscript>2</superscript>)</para>
    <para>B = Magnetic induction (T)</para>
    <para>J = Current density (A/m²)</para>
    <para>ρ = Charge density (C/m³)</para>
    <para>The resolution of these equations can be obtained, generally speaking, both through purely analytical methods and through numerical methods. In the first case, however, only relatively simple problems have so far been successfully addressed, such as the absorption of a plane wave by an infinite tissue surface, possibly consisting of several layers, or by spheres, and the absorbed electric field has been obtained in a closed form. Despite the major simplifications needed by the analytical approach, the latter has definitely helped in understanding the theoretical basis of the power absorption by a biological body, and in identifying the parameters that play a major role in this process.</para>
    <para>In the case of numerical analysis, on the other hand, the electromagnetic equations are solved by algorithms that use numerical approximation. The rapid development of computational capacities during the last decades has made it possible to greatly reduce the impact of such approximation and to carry out studies on models that are very close to the actual system under investigation.</para>
    <para>The numerical computation of the induced electromagnetic field inside the human body is the starting point for the study of the possible effects of electromagnetic fields on biological systems and the mechanisms underlying them. The parameter typically used to characterize the interactions between electromagnetic fields and tissues is the power absorbed per unit of mass or the specific absorption rate (SAR) measured in watts/kilograms (W/kg).</para>
    <para>SAR is a function of the electric field and conductivity of biological tissues, according to the following:</para>
    <para>SAR = ΔP/ρΔV = 1/2 σ · |E|²/ρ                    (5)</para>
    <para>P = total power (W);</para>
    <para>ρ = tissue density (kg/m³)</para>
    <para>V =volume (m³)</para>
    <para>σ = electrical conductivity (S/m)</para>
    <para>E = electric field (V/m)</para>
        <sect2 id="ch0023s0000s0001s0001">
          <title>MRI Bioeffects, Safety, and Patient Management     615</title>
    <para>The SAR is the typical parameter adopted by international regulations that address the protection from electromagnetic fields, as a basic parameter for the risk assessment. Such a choice derives from the consideration that the whole-body averaged SAR and local SAR are suitable quantities to compare the effects of electromagnetic exposure under different conditions. The SAR value resulting for a given exposure condition can also be related to the local induced temperature increase, thanks to the bioheat equation (1), which describes the heat exchange mechanisms within biological tissues:</para>
    <para>c(r)ρ(r) ∂T(r,t)/∂t = ∇ · [K(r)∇T(r,t)] + A(r,T) - B(r,T)[(T(r,t) - T<subscript>b</subscript>(t)]</para>
    <itemizedlist>
      <listitem><para>(6)</para>
      </listitem>
      <listitem><para>-S(r,t) + SAR(r)ρ(r)</para>
      </listitem>
    </itemizedlist>
    <para>r = spatial vector (m)</para>
    <para>t = time (s)</para>
    <para>c = specific heat capacity (W s/K kg</para>
    <para>ρ = tissue density (kg/m³)</para>
    <para>K = thermal conductivity (W/m K)</para>
    <para>A = metabolic rate (W/m³)</para>
    <para>S = heat loss at tissue/air interface (W/m³)</para>
    <para>B = blood flow coefficient (W / K m³)</para>
    <para>SAR = absorbed energy rate (W/kg)</para>
    <para>In parallel with the development of modeling/numerical techniques, the effects of the interactions between electromagnetic fields and biological tissues have also been investigated through experimental studies. In many cases, experimental measurements have represented the starting point for the definition of the numerical model, as well as the source of data necessary for the validation of the model itself.</para>
    <para>However, by analyzing these experimental studies and the limitations necessarily related to them, the great importance of numerical models and simulations is even better highlighted. Generally speaking, experimental studies evaluate the electromagnetic field interactions with biological tissues by exposing a physical model of the human body, typically referred as a "phantom", to the electromagnetic field. The strong simplification needed by the physical model compared to the case of actual biological tissues makes it difficult to immediately extend the results obtained to what can be expected in the real case in human subjects without any further analysis. In addition, the measurement of the electromagnetic quantities (e.g., electric field, induced currents, etc.) without perturbing the system is often a difficult challenge that must be adequately addressed. Therefore, an indirect measurement is often preferred, considering, for example, quantities, such as the temperature, that are</para>
    <para>more easily accessible, but that, in any cases, must then be related to the electromagnetic quantities of interest always through mathematical models.</para>
    <para>In consideration of the above, the modern computational capabilities and computing powers that have grown continuously in recent years have made the modelistic approach an excellent means to describe the interactions between electromagnetic fields and biological tissues, not only limited to the research field. Presently, numerical simulations are used as a predictive and design support tool in different contexts, from the industrial prototyping of new devices to the regulatory compliance evaluation in terms of electromagnetic compatibility issues.</para>
        </sect2>
      </sect1>
      <sect1 id="ch0023s0000s0002">
        <title>NUMERICAL MODELS APPLIED TO MRI SIMULATIONS: A BRIEF HISTORY</title>
    <para>The evaluation of the possible effects induced by magnetic resonance imaging (MRI)-related electromagnetic fields on a patient bearing a metallic implant is an excellent example to demonstrate the important role that computational modeling plays today. MR systems generate time-varying gradient magnetic fields and pulsed radiofrequency (RF) fields in the presence of a powerful static magnetic field to create an image of the body. Together, the three electromagnetic fields (static, time-varying gradient magnetic fields, and RF fields) create a hostile environment for any metallic device implanted in the patient, in particular for active implanted medical devices (i.e., medical devices relying on functioning by a source of electrical energy or any source of power other than that directly generated by the human body or gravity) such as a cardiac pacemaker, an implanted cardioverter defibrillator, a neurostimulation system or a cochlear implant.</para>
    <para>The scientific community has been engaged in finding a practical solution to extend the unparalleled benefits of MRI to patients implanted with metallic devices since the early 1990s (2-8). Numerical analysis has been widely adopted for the design and optimization of MR systems: for the optimization of static magnetic field homogeneity and for shimming (9-14); for the design of gradient coils and their optimization (15-19); for the design of transmit RF coils and optimizing RF field homogeneity (20-26); and for the design of receiver coils and the assessment of the signal-to-noise ratio for MR images (27-33). Numerical tools were also adopted to model the human body's exposure to the three aforementioned components of the electromagnetic fields generated by the MR scanner. Electromagnetic modeling has been used to evaluate the biological effects related to the power static magnetic fields of MR systems (34-36), the peripheral nerve stimulation caused by the time-varying gradient magnetic fields (37-39), and safety aspects of RF power deposition and resultant tissue heating during MR signal excitation (40-50).</para>
    <para>However, the modeling of the interactions with the human body in presence of a metallic implant, definitely suffered from the oversimplifications made necessary by the computational resources available at that time, and tools based on numerical simulations played, in this field, a secondary role compared to experimental measurements and <emphasis role="italics">in vitro</emphasis> studies.</para>
    <para>Indeed, Maxwell equations have to be solved to simulate the interactions of the electromagnetic field with the implanted medical device. For a 1.5 Tesla MR scanner, the Lar-</para>
    <para>MRI Bioeffects, Safety, and Patient Management     617</para>
    <para>mor frequency is 64 MHz, which corresponds to a wavelength in human tissues of approximately 40 cm. Therefore, the wavelength is about the size of the studied object, and full-wave simulations need to be run, meaning that no approximation on Maxwell equations can be made. This is true for MR systems that works at 3 T (Larmor frequency =128 MHz, wavelength in human tissues of about 20 cm) as well. Thus, in order to reduce the computational costs of the model, the human body was often represented as a homogeneous domain with a simple geometry (e.g., rectangular or ellipsoidal) (51-54), or only a part of the body, such as the head, could be modeled taking into account the different tissues properties (55-57). In addition, the model of the implant could not account for the actual structure and geometry of a real device (i.e., the insulation sheet and the arrangement of the inner wires of the lead were not considered) (58-62).</para>
    <para>In vivo and in vitro experimental studies demonstrated the complexity of the interactions between the MR system, the human body, and the medical implant, and described multiple variables that may play an important role in such interactions, including the patient's size, anatomy, body composition, the patient's position in the MR system, the pulse sequence, (which included RF power level), lead routing, and lead design (63-66). The consequence of the great number of variables involved led to a substantial variability in the results presented in the peer-reviewed literature and indicated how the characterization of an implanted device in a patient undergoing MRI was an extremely complex problem.</para>
    <para>While the experimental approach could demonstrate in a relatively easy way the hazards related to the exposure of a patient implanted with a device to the MRI-related electromagnetic fields, it was far more difficult to prove a solution to these hazards because of the complex and unpredictable nature of the MRI-implant interactions. The use of phantoms, which do not account for the anatomical details and differences in terms of dielectric properties of different tissues, does not allow the results to be immediately extended to what occurs in a human subject. In addition, the simple measurement of a parameter does not allow any interpretation of the mechanisms underlying the phenomenon and does little to identify any strategies to reduce the risks associated with the parameter of interest. Thus, it became evident early on that there was a need for a different approach that was able to provide an interpretative and predictive key to the phenomenon: the modeling and numerical analysis.</para>
    <para>As the computational resources increased over the years, the reliance on numerical calculations increased as well. Such an increase was supported by the possibility of performing systematic analyses of the several variables affecting the interactions between the MRI electromagnetic fields and the implanted device, with decreased costs and increased reproducibility compared to performing experimental measurements. Computer-aided modeling demonstrated a practical and efficient method for exploring millions of variable combinations in a holistic manner. Additionally, computer modeling allowed the analysis of parameter extremes, outside the bounds of normal clinical practice, which permitted further assessment of safety margins and the sensitivity of influencing variables. The results of model simulations enabled predictions to be made about what would happen in the "real" system that was being studied in response to changing conditions, and to obtain information virtually impossible to obtain by experiments, like the electric fields inside a human body.</para>
    <para>For all of these reasons, present-day numerical simulation has become an indispensable means of safety testing for metallic devices associated with MRI, not only for research purposes, but also for medical device manufacturers to affordably obtain MRI-related safety labeling for their products. As an example, the first cardiac pacemaker implant that obtain the FDA clearance as MR Conditional in 2009 used modeling data to support regulatory submissions for approval. In particular, the modeling data was, in fact, the primary vehicle to demonstrate safety for this active cardiac device (67).</para>
    <para>Considering the complexity of the electromagnetic problem, most of the modelistic methods implement the numerical solution of the Maxwell's equations. The vast majority of numerical field calculations performed for MRI of the human subject, without or with a metallic implant, are related to the RF fields. Whereas perturbations associated with the static magnetic and time-varying gradient magnetic fields due to the presence of the human body in the MR system are only a few parts per million (on the order of 0.000001 times the applied field), perturbations in the RF field can easily be tens of a percentage (on the order of 0.1 times the applied field in free space). In addition, RF field-induced heating in tissue (concomitant with the maintenance of the RF field in a lossy medium) must be understood and monitored to avoid excess heating or a burn injury in a patient (68). This is also the major concern when assessing the MRI issues for a metallic implant that is present in a patient undergoing an MRI examination.</para>
    <para>Several numerical methods exist, each of them solving the Maxwell's equations following a specific algorithm. However, every numerical method has the implicit limitation of not solving solutions in a linear continuum. Every physical system has to be discretized in finite domains, so that the numerical solution is computed based on partial differential equations. The geometry of the physical systems involved in the problem is partitioned into elements of space or cells, in which the differential equations can be computed. The entire net of elements discretized into the numerical system is typically named by the term, "mesh". Several meshes can be implemented based on the specific grid of elements defined. In general, a mesh can be classified based on the following factors:</para>
    <itemizedlist>
      <listitem><para>Domain dimension: One-, two-, or three-dimensional;</para>
      </listitem>
      <listitem><para>Element type: Triangular, tetrahedral, quadrilateral, hexahedral, or a mix of more than one type;</para>
      </listitem>
      <listitem><para>Element aspect ratio: Isotropic or anisotropic;</para>
      </listitem>
      <listitem><para>Mesh density: Uniform or graded mesh; and</para>
      </listitem>
      <listitem><para>Topology: Structured or unstructured mesh.</para>
      </listitem>
    </itemizedlist>
    <para>A structured mesh presents a regular topology with a well-known pattern. Conversely, an unstructured mesh has an irregular topology where the connectivity of the grid is part of the data structure. Once the mesh is defined, then the relation to the physical system within each element of the numerical space has to be found. What needs to be defined then is the algorithm that is able to solve the physical problem in the discretized space for the specific characteristics chosen. Several numerical methods exist to solve a physical system, however</para>
    <para>each one is defined with respect to its numerical implementation. Thus, every method cannot be independently defined by the algorithm.</para>
    <para>The methods used to solve Maxwell's equations in a physical system are based on differential or integral equation solvers, such that they discretize the differential or integral form of Maxwell's equations. Both methods can be solved in the time or frequency domain. In the time domain, the frequency range of interest is specified, and a gaussian signal with the frequency information is defined. Then, the signal is transformed into the time domain by using an inverse Fourier transformation, resulting in a time signal with a gaussian envelope. The system is then excited with this time pattern.</para>
    <para>Conversely, in the frequency domain, the behavior of a physical system is usually relevant in a specified frequency range. Thus, no information can be concluded for a single frequency. Hence, several simulations in the frequency band of interest have to be performed, the number of which are defined by the software algorithms to achieve a predefined accuracy of results by interpolation of points.</para>
    <para>The most favorable methods for this type of problem, in terms of memory requirements and simulation time are the Finite Difference Time Domain (FDTD) (69) or the Finite Integration Technique (FIT) solved in the time domain. These time domain solvers require reasonable memory and simulation time compared to the frequency domain solvers (FEM, Finite Element Method; MM, Method of Moments) (70). Moreover, these algorithms tend to be easily implemented on Graphic Processing Units (GPUs) allowing a tremendous acceleration of the simulations with a hardware cost way below the cost for a cluster of central processing units (CPUs).</para>
    <para>One drawback of these time domain solvers is the hexahedral mesh, which is much less flexible than the tetrahedral mesh of a finite element solver. However, the possibility of using a conformal mesh permits the ability to follow the strong curvature of a geometry without having to dramatically refine the mesh. This is even more important because the smaller the mesh step, the smaller the time-step of the time domain solver.</para>
    <para>The FDTD method is a related space-grid, time domain technique that involves the resolution of Maxwell's equations on their differential form. Since its introduction by Yee in 1966 (69), the FDTD method has been widely used for a broad range of electromagnetic applications including geophysical, bioelectromagnetic, and biophotonics (71) and this technique experienced an exponential growth starting from its first proposal. One of the major reasons for such growth is the increase of computational performances for a given cost of technological resources.</para>
    <para>Because the FDTD algorithm is based on the solution of Maxwell's equations on their differential form, it is required to define the boundaries condition of the problem. In particular for wave-propagation problems in unbounded media, artificial boundary conditions have to be used to eliminate the reflections from the edge of the finite computational domain (72). A major turning point of the method for the study of wave propagation problems was the introduction of the perfectly matched layers (PML) by Berenger in 1992 (73). One of the characteristics of the FDTD method is that as the resolution of the sampled object is refined, the time required by the simulation to reach the Courant Friedrich Levy condition</para>
    <para>grows. This is a direct consequence of the intrinsic definition of the time-step as directly proportional to the square root of space resolution (71). Thus, the smaller the resolution, the smaller the time-step, and the higher the number of time-step intervals required to perform a time-defined simulation. Presently, computers are able to simulate increasing simulation space with higher resolution steps within a reasonable amount of time for each simulation. As described by Taflove, et al. (71), there are several reasons for the popularity of this method, including its robustness and systematicity. On the other hand, one of the major disadvantages of the technique is due to the inability of modeling smooth curved and tilted profiles. Without implementation of a specific algorithm, a curved or tilted profile implemented in FDTD will be affected by "staircasing". Although the simplest and most frequently used approach is the staircasing approximation, it has been reported that there is a solution inaccuracy related with the staircasing effect (74, 75). Moreover, an error of up to 2% error can be committed in the evaluation of the resonance frequency of a resonant object with respect to the tilted angle of the object with Cartesian axes of the grid (74).</para>
    <para>In addition to the staircasing approximation, in the past years several methods have been proposed to generate a conformal mesh for tilted and curved profiles. Among all, four categories can be highlighted: the contour path (CPFDTD) algorithm (76), the non-orthogonal FDTD (77), the hybrid methods using FDTD-FEM (78) or FDTD-MoM (79), and the sub-gridding method (80). Even though these methods have been extensively discussed and compared (81), the original FDTD Cartesian grid for the simulation of a radiofrequency (RF) coil for MRI has been, to date, the most commonly used methodology adopted in the peer-reviewed literature.</para>
    <para>Other methods including the Method of Moments (MoM) and the Finite Element Method (FEM) are very good for creating accurate representations of good conductors of arbitrary geometry, but rely on methods such as matrix inversion that work best for sparsely-populated spaces. Finite element representations of the human body are used occasionally in MRI (82-84), but due to the computational requirements, the representations tend to have far more homogeneous representations of far fewer tissue types than FDTD methods can accommodate on a given system.</para>
    <para>The FEM method is a near-neighbor, volume method for solving Maxwell's differential equations in the frequency domain. The physical space is divided into a non-structural grid, composed of meshes of small volumes or cells of tetrahedral elements, and this fact makes this method very suitable in modeling inhomogeneities and complex geometries. Once the volume has been subdivided, the unknown field within each element is approximated using linear extrapolation, starting from a sparse system equations matrix. The solution is given by the inversion of this matrix. The FEM can couple the electromagnetic solution with other physics, such as those associated with mechanical and thermal problems. However, it could be inefficient in the treatment of highly conductive radiators due to the requirement to have some mesh between the radiator and the absorber, and the mesh could be very complex, resulting in a meshing time that is longer than the solution time.</para>
    <para>The MoM is a full wave solution of Maxwell's integral equations in the frequency domain. The radiating/scattering structure is replaced by equivalent currents (normally surface currents) that are discretized into wire segments. Then, a matrix equation is derived and</para>
    <para>able to describe the interaction of every source segment on every other segment, computed with the Green's function. The strong points of this method are that: (1) it is unnecessary to discretize the "air space" around the antenna, leaving only the antenna and the region of interest to be considered; (2) only the surface is meshed; and (3) there is an efficient treatment of highly conducting surfaces. However, the MoM does not handle electromagnetically penetrable materials, especially if the material is inhomogeneous, and requires the surfaces to be closed, which is often impractical.</para>
    <para>To represent both the transmit RF coils and human body accurately in the same simulation, some groups have devised hybrid methods combining more than one method and sharing results between them (85). After an electromagnetic simulation, the specific absorption rate (SAR) distribution that is obtained is then scaled for each real RF pulse of the sequence and can be given as an input to the transient heat equation solver.</para>
    <para>For the magneto-static problem, to assess the interaction of the field with complex geometries, the most frequently used method is the FEM. For gradient magnetic fields for which the frequency is a few kHz, approximations can be made on the Maxwell equations and the most common method used is the FEM (86).</para>
    <para>Today, the crucial role that the numerical simulations play in the evaluation of the electromagnetic field generation, propagation, and interaction with the human body, not only limited to research purposes but also for industrial design and manufacturing, is revealed by the several tools that are commercially available. The main commercial simulation software available on the market providing a time domain solver are CST Microwave Studio™ (CST GmbH, Germany), Sim4Life™ (Zurich MedTech AG, Switzerland), XfdId™ (REMCOM Inc., USA), and FEKO™ (Altair Development SA, South Africa). ANSYS™ (ANSYS Inc., USA) and COMSOL Multiphysics™ (COMSOL Inc., Sweden) are finite-element solvers that are mainly used in the frequency domain.</para>
    <para>Parallel to the growth of the electromagnetic solver capability and computational efficiency, numerical human phantoms additionally evolved tremendously since the first need for these in the 1960s (87), from an approximate geometric model to the very detailed anatomical models existing today. The first numerical phantoms adopted in electromagnetic simulation were "stylized phantoms". These phantoms were the first generation of computational phantoms and were also called the mathematical phantoms (88, 89). They were implemented and used mainly between the 1960s and 2000s.</para>
    <para>Stylized phantoms were introduced to assess the dose exposure in body organs and tissues that were described by mathematical expressions representing planes or cylindrical, conical, elliptical or spherical surfaces. All of the models developed over the years were representative of the "average or standard individual" as defined by International Commission on Radiological Protection (ICRP) data on the reference man (89). The most utilized stylized phantom model was the "MIRD" model. This phantom was named after the initials of the Medical Internal Radiation Dose (MIRD) Committee of the Society of Nuclear Medicine based in the United States (U.S.). The MIRD phantom was first introduced by Fisher and Snyder in 1967 and later refined (90, 91). The refined model shown in <emphasis role="bold">Figure 1</emphasis> was representative of an adult human model. In the following years, several other models that were part of the MIRD-type phantoms were released, representing infants and children of</para>
      </sect1>
      <sect1 id="ch0023s0000s0003">
        <title>The Role of Numerical Modeling and Simulations</title>
  <para>various ages, separate male and female adult models named Adam and Eva, and three phantoms representing the adult female in three stages of pregnancy (92-95).</para>
    <para>The second generation of computational phantoms was the voxel phantoms. The voxel models were first presented as a "tomographic-type" and were introduced in 1984 by Gibbs, et al. (96) and in 1986 by Williams, et al. (97). These numerical models were generated from medical imaging data collected through MRI or computed tomographic (CT) scans. The voxel models were able to provide three-dimensional representations of the human body by volume elements of the same size (i.e., voxel) but representing the anatomical structures of the human body (e.g., white matter, muscle, bone, etc.).</para>
    <para>Since their introduction in 1980s, the voxel models are still in use, and a large number of them are free to download or are commercially available. In the context of the MRI exposure assessment, one of the first studies on this important topic was performed by Dimbylow in 1996 (98). The exposure was computed on the NORMAN (i.e., NORmalized MAN) human voxel model with a weight of 73 kilograms (kg) and height of 1.76 meters (m). The model was implemented based on MRI data from a series of continuous, partial body scans of a single subject. Because the concept of the ICRP reference man was still strong, the final dimensions of the model were scaled so that the mass and height would agree with the new values for the reference man. Over the years, additional models were developed, including the Visible Human Man (VHM) and Visible Human Woman (VHW), which were completed in November 1994 and 1995, respectively. The VHM and VHW were the result of the visible human project led by the U.S. National Library of Medicine that started in 1956 and formed the basis for a large number of MRI safety assessments.</para>
    <para>With the growth of computational power and imaging resolution, several other models were introduced. In particular, volumetric models were adjusted by using surface description methods, which allowed smoother surfaces that could be meshed at one's convenience, with</para>
        <sect2 id="ch0023s0000s0003s0001">
          <title>MRI Bioeffects, Safety, and Patient Management     623</title>
    <para>a high-resolution that is essential when fine body structures were studied (99). Among all of the models available today, one of the more popular ones that are used for the assessment of electromagnetic exposures are the phantoms of the Virtual Family (100), which were expanded to the Virtual Population (101). The populations include models of males and females ranging from an infant to an older adult. Models of pregnant woman and obese human are also present.</para>
    <para>Recently, a further improvement for computational phantoms is represented by the boundary representation (BREP) phantoms. The BREP phantoms are computational human models that contain exterior and interior anatomical features of a human body using the boundary representation method. With respect to the voxel models, the BREP phantoms are deformable phantom whose geometry can be conveniently transformed to fit particular physical organ shapes, volumes, or body postures. The operations that are possible to perform on BREP phantoms include extrusion, chamfering, blending, drafting, shelling, and tweaking (89). These features allow BREP models to include very complex anatomical features, as well as surface deformations. More details about the human phantoms adopted today in MRI numerical simulations, as part of complete model of interactions between the MR scanner and the patient, are provided in the next section.</para>
        </sect2>
        <sect2 id="ch0023s0000s0003s0002">
          <title>THE COMPLETE MODEL OF INTERACTIONS BETWEEN MR SYSTEMS AND PATIENTS WITH IMPLANTED LEADS</title>
    <para>Patients with active implants that incorporate one or more leads (e.g., cardiac pacemakers, neurostimulation systems, cochlear implants, etc.) are often referred for MRI examinations. Importantly, to ensure the safe use of MRI technology in these individuals, comprehensive <emphasis role="italics">in vitro</emphasis> testing is necessary to evaluate the various MRI issues that exist, especially MRI-related heating of the leads. As part of this assessment, modeling is often performed because of the above-mentioned reasons. Modeling of the interactions between the MR system and the patient implanted with metallic leads faces three major challenges:</para>
    <para>First, there is inter-MRI examination-related variability. The initial studies that focused on the MRI safety of biomedical implants immediately highlighted that there are several factors that greatly impact the results and that justify the large variations of the findings reported in the peer-reviewed literature. For example, the type of MR scanner that is used and imaging conditions (e.g., the static magnetic field strength and frequency of the transmitted RF fields, the pulse sequence parameters, the duration of the scan, the body part undergoing imaging, etc.) vary between MRI procedures. Furthermore, other factors influence the level of lead heating that occurs during MRI such as the patient's position in the transmit RF coil, the position of the implant and the lead configuration inside the patient, and the patient's characteristics (e.g., size, morphology, and posture). In addition, variations exist in the length and design of the lead as well as in the type of implanted device that is present in the patient (i.e., cardiac pacemaker versus spinal cord stimulation system). Thus, the large number of different combinations of the factors mentioned above makes individual simulations of each combination a particularly challenging problem.</para>
    <para>Second, there is body tissue heterogeneity. The different tissue types present in the human body are both geometrically complex and differ strongly in dielectric properties.</para>
        </sect2>
      </sect1>
      <sect1 id="ch0023s0000s0004">
        <title>The Role of Numerical Modeling and Simulations</title>
    <para>Just to get an idea, Liu, et al. (102) used conductivity values ranging from 0.02 S/m (yellow bone marrow) to 2.3 S/m (cerebrospinal fluid) and values for the relative permittivity ranging from 7 (fat and mammary tissue) to 128 (intestine/bowel content) in their simulations of an MR scanner operating at 64 MHz (1.5 T scanner).</para>
    <para>Third, this is a multi-scale problem. Importantly, several length scales are present in the problem. At 64 MHz, the wavelength λ0 of the RF field in free space is roughly five meters. Thus, the human body has a size of approximately λ0/3. Inside the body, the wavelength is reduced to λ = λ0/√εr, where εr is the relative permittivity of the body tissue. Despite this reduction of the wavelength, in many cases the components of the implanted device (e.g., the insulation sheath of a cardiac pacemaker lead) have dimensions on a length scale of approximately λ/1000. Volume discretizing methods are able to resolve these length scales concurrently but are limited by overwhelming simulation times and memory requirements.</para>
    <para>As shown in <emphasis role="bold">Figure 2</emphasis>, the three main components of the model of interactions between the MR scanner and the patient implanted with a device, that is, the MR scanner, the human body, and the implant. Each component varies in terms of size and the resolution needed for the respective model.</para>
    <para>The implant extends typically over an area of approximately 30 cm² and must account for very small details, such as the thickness of the insulation sheath that cover the metallic lead and the geometry of the lead tip, that cannot be ignored in order to obtain reliable results and that entail the need to maintain a resolution of less than 1 mm. The human body has extremely complex geometry of weakly-conductive material that today is most readily represented on a high-resolution regular three-dimensional grid, with a minimum step of</para>
  <para><emphasis role="bold">Figure 2.</emphasis> The three main components of the model of interactions between the MR scanner and the patient implanted with a device: the MR scanner, the human body, and the implant. Each component varies in terms of size and the resolution needed for the respective model.</para>
        <sect2 id="ch0023s0000s0004s0001">
          <title>MRI Bioeffects, Safety, and Patient Management    625</title>
    <para>less than 1 cm. The MR scanner with its components (time-varying gradient magnetic field coils and transmit RF coil) covers a volume of about 120 <emphasis role="italics"> 120 </emphasis> 120 cm<superscript>3</superscript>, with a required resolution that generally does not exceed 1 cm. Running a simulation with such constraints is computationally expensive because it leads to a large number of discretization cells (up to 200 million cells) and a complex distribution of material of different electrical properties.</para>
    <para><emphasis role="bold">The Model of the MR System</emphasis></para>
    <para>The risks of MRI-related electromagnetic fields on implanted devices arise from three basic aspects of scanning (103-105). Magnetic resonance utilizes extremely powerful static magnetic forces (usually 30,000 to 60,000 times the Earth's magnetic field). This powerful magnetic field has the theoretical potential to move or dislodge an implanted metallic device. MRI also involves the use of time-varying gradient magnetic to image the scanned field of interest. These rapidly varying magnetic fields have the potential to induce electrical currents. Finally, MRI uses "pulsing" RF energy during the scanning process. If the implanted metallic device acts like an "antenna", this RF energy has the potential to cause substantial localized heating or to induce electrical currents.</para>
    <para>Today, the materials typically used in implanted biomedical devices have physical properties that make mechanical effects (i.e., force and torque) negligible in association with static magnetic fields. As an example, reports confirm that, indeed, the forces for cardiac pacemaker pulse generators exposed to 1.5 T and 3 T MR scanners tends to be lower than the gravitational force exerted by the Earth (106, 107). More dangerous are the effects related to the time-varying gradient magnetic fields and the RF fields, in particular when the implanted device is an active implanted medical device (105).</para>
    <para>Devices such as cardiac pacemakers or ICDs have the ability to sense several physiological parameters of the patient and to modulate their activity, accordingly. The gradient magnetic fields and/or RF fields may affect the proper sensing activity, causing an inappropriate functionality of the device. In MR Conditional devices, this hazard has been mitigated by introducing a specific mode of operation, called the "MRI Safe Mode", "MRI Protection Mode" or other suitable term, that temporarily switches off the sensing ability of the active cardiac device, preventing any form of interference.</para>
    <para>The heating generated at the tissue/device interface due to the electrical currents induced during the scanning process represents the most significant and potentially dangerous effect of the complex interactions between the implant and the MR system, in particular for those devices that used long metallic leads. Since the magnitude of the RF field is several times higher than the gradient magnetic fields, the induced heating is mainly due to the RF field. For this reason, the vast majority of numerical field calculations performed for MRI of the human subject implanted with metallic devices are related to the RF fields.</para>
    <para>RF coils can be distinguished into surface coils, array coils, or volume coils. Volume coils (e.g., the transmit body RF coil) completely encompass the anatomy of interest and are mostly operated as transmit RF coils coupled with receive-only coils but are also capable of operating as transmit/receive RF coils. Volume coils are typically cylindrical and rely upon a sinusoidal distribution of currents arranged circumferentially around the tube and</para>
    <para>running along the length of the coil to create a transverse magnetic field. Such RF coils, as the birdcage and the transverse electromagnetic (TEM) resonator, were designed to generate a very homogeneous RF excitation field B<subscript>1</subscript> across the entire covered volume.</para>
    <para>A surface RF coil consists of a partial loop of wire having dimensions that match the area of interest and its inductance in resonance with the capacitance at the Larmor frequency. The inhomogeneous field profile of surface RF coils restricts their use primarily to the receive-only mode, except in the case where adiabatic pulses or trains of pulses are used to reshape the flip angle profile. However, they are, as their name suggests, good for detecting signals at a much higher SNR close to the surface of the patient. RF array coils are used to reduce imaging time by their ability to spatially localize signals.</para>
    <para>Volume coils, and in particular birdcage coils, are the most common type of RF coils adopted as RF sources in the numerical field calculations performed for MRI of the human subject. The issue is to tune it properly to get the wanted homogeneous mode of the resonant structure. The birdcage body coils are implemented using two circular rings named end-rings connected by a certain number N of straight longitudinal connectors named rungs or legs. The RF field produced by the birdcage coil is the result of the currents flowing in the rungs. The currents flowing in the RF coil system is the result of the resonance of each network component of the coil structure.</para>
    <para>In 1997 work, Leifer (108), accurately described the theory behind the birdcage resonator, through a simple LC (also called resonant circuit) circuit. Leifer solved the birdcage coil using Kirchoff's mesh equations on the coil network. Leifer described the network as a generalized "band-pass" birdcage containing capacitors in both the end-rings and rungs. From the same structure "low pass" and "high pass" coils can be derived as special cases of the general band-pass coil. The three coil typologies are characterized by different resonant "modes". In fact, because of its geometry, the birdcage resonator shows a periodic or cycling nature. The periodic waves produced are named "modes" of resonance and their number is dependent on the number of coil rungs, such that the modes of resonance are those that show an integral number of wavelengths around the coil structure, each with a different field pattern and frequency of operation. Theory demonstrates that the number of resonant modes in a birdcage coil is strictly related to the number of rungs N, and equal to N/2 -1. In addition to those, Leifer (108) showed that a mode of resonant can exist in which the currents flow in the same direction in each end ring. Because of co-rotating currents in the end rings, this mode was named Helmholtz or the co-rotational (CR) mode, and it can be constructed from any combination of currents in the LC network. This mode, however, doesn't produce any propagating wave around the RF coil, hence it doesn't generate a magnetic field in the sample region. With the addition of this last Helmholtz mode, a total of N/2 + 2 resonant mode exist in a birdcage coil of N rungs. Between the N/2 +2:</para>
    <itemizedlist>
      <listitem><para>The mode of resonance with periodicity or order equal to 0 has equal and opposite ring currents and zero rung currents. It is called the anti-rotational (AR) ring mode.</para>
      </listitem>
      <listitem><para>The 0 mode is followed by the CR mode that is not identified by a periodicity or order number.</para>
      </listitem>
      <listitem><para>The mode of resonance with periodicity or order equal to 1 is the only one able to generate a homogeneous magnetic field. Thus, this is the typical mode used for imaging.</para>
      </listitem>
      <listitem><para>All the other modes generate a magnetic field with a null at the center of the birdcage coil.</para>
      </listitem>
    </itemizedlist>
    <para>Low pass and high pass models present the same number of resonance modes, but they differ by showing a low or a high resonance spectrum, respectively. In particular for a low pass birdcage type, the AR and CR modes degenerate at zero frequency, with higher-order modes increasing in frequency. Conversely, in high pass birdcage type, the AR and CR modes form a doublet in high frequency, with higher-order modes decreasing in frequency.</para>
    <para>Over the years, the RF birdcage coils have been proffered as the main implementation of RF coil for approximating the B<subscript>1</subscript> propagation in the patient. However, the presence of a patient can affect the B<subscript>1</subscript> homogeneity. As a result, there may be areas within the body of the patient in which the transmit RF field is substantially weaker than in other regions. Additionally, the loss of homogeneity increases with the static magnetic field strength and with the RF coil's dimensions. For this reason, other technologies have been implemented to overcome the loss of field homogeneity. The more relevant ones are the Transverse Electromagnetic (TEM) resonator coils, and the parallel multi-transmit RF coils. The TEM resonator was first introduced by Vaughan in 1999 (109). The structure of the TEM resonator differs from the one of a birdcage coil in two ways. First, longitudinal connectors of the birdcage coil are replaced in the TEM coil with microstrips that are affixed to the inner surface of a non-conducting cylinder. Second, in the birdcage coil the rungs current use the end-rings as a return path, whereas in the TEM resonator the microstrips are all connected to the outer thin metallic shield. Thus, inductance and self-resonance of the TEM coil are independent of RF coil's diameter, because the TEM coil return path follows the shield rather than the end rings. The main characteristic of the TEM resonator is that at high frequencies, it becomes a cavity resonator or longitudinal transmission line in which oscillating standing waves develop.</para>
    <para>The increase of the SNR has always been the main target of improvement for RF birdcage body coils. To this aim, the use of multi elements excitation was adopted as a measure to improve the RF homogeneity in the excited volume. The simple birdcage coil was seen as a multi-element transmit coil array that could allow for an independent adjustment of amplitude and phase of the signal feeding each element of the coil. Starting from 2000s, this concept was evolved and made to take advantage of this method to reduce the RF inhomogeneities in the patients, particularly at high static magnetic fields (110). This new RF modality is also known as parallel multi-transmit or RF shimming. The degree of freedom given for each element of the coil to be fed with a specific waveform, permitted the ability to more carefully control and increase the homogeneity of the B<subscript>1</subscript> field generated by the RF excitation. Thus, the main concept of the multi-transmit coil is that the power is distributed to the feeding sources of the transmit RF coil (typically a TEM resonator) using two or more independent channels. A second advantage of these transmit RF coils is that they can be also used in a parallel receiving mode with a consequent reduction of the acquisition time.</para>
    <para>The structure of the birdcage coils allows for multiple feeding conditions within the coil rings. Depending on the source number, and feeding phase and amplitude, different polarization of the produced magnetic field can occur. Historically in the 1980s, the birdcage coils were fed using a single port coil, such to achieve a linearly polarized field. However,</para>
    <para>with such polarization, "quadrupole" artifacts were present in the resulting MR image (111). These artifacts manifested as "holes" or voids of decreased image intensity that could not be attributed to any anatomical feature of the patient scanned.</para>
    <para>By running simulations with cylinders of different size and material, it was evident that the "holes" were caused by the asymmetric nature of induced eddy currents that derive from the finite conductivity of the medium. To overcome this artifact problem, it was suggested to implement the circularly polarized birdcage coil with two feeding ports. The two ports were fed with the same amplitude and differential phase of 90° in order to generate a purely rotating wave. With this new polarization, a 1.4 and 1.6 higher SNR was observed with respect to left/linear and right/linear polarization, respectively.</para>
    <para>The linear polarization is then considered less efficient for MRI because half of the transmitted power is not used for the imaging process. The circularly polarized field is obtained by adding to the original linearly polarized field, a second field generated by sinusoidal current phase shifted by 90°. This is typically obtained by a quadrature transmission of signals in the RF birdcage coil.</para>
    <para>This can be achieved by two or more feeding sources around the coil ring. When such a circularly polarized field is generated, the two counter-rotating components of the two generated fields (i.e., B<subscript>1</subscript><superscript>-</superscript>) cancel each other, whereas the subfields effective at inducing MRI (i.e., B<subscript>1</subscript><superscript>+</superscript>) add together. Hence all of the power is used for imaging and an overall higher efficiency is achieved. Presently, the RF coil implemented in a clinical MR system uses the highly efficient, quadrature excitation. Conversely, linearly polarized transmit RF coils are restricted for use in small animal imaging.</para>
    <para>Besides the time-varying magnetic field (B<subscript>1</subscript>) used for the excitation of the magnetization vector, when a conductive media, such as the human body, is present inside or in close proximity to the RF energy, an altering voltage or electromotive force is induced inside the conductive media by the variation of the magnetic flux. The electromotive force generates eddy currents inside the media that, in turns, generate a secondary magnetic field and a corresponding additional voltage. Overall, the induced internal fields are strongly dependent on both the incident field, and the size, shape, and dielectric properties of the exposed medium. The voltage induced by B<subscript>1</subscript> is much larger than the secondary one. However, within the human body it can be considerably high enough to perturb the primary field. This is due to the complexity of the body's anatomy and to the inhomogeneity of the dielectric properties of the tissues.</para>
    <para>Additionally, an electric field can be generated within the body by the distribution of electrical potential specific to a given resonant structure. In MRI, such an electric field is typically named "conservative" or "capacitive". One possible situation in which the capacitive effect should be taken into account is when the medium is in close vicinity to the RF resonator. All these elements must be considered in the development of the model of the transmit RF coil used for MRI. For an ideal computation, the entire RF coil (with the actual power supply and the tuning capacitors able to produce the circularly polarized magnetic field), should be reproduced using a grid resolution fine enough to adequately account for the detail of the implanted device under investigation. As previously mentioned, the challenge is to combine a simulation of large dimensions (i.e., the length of the MRI's transmit</para>
    <para>RF coil &gt; 1 m) and small structures (i.e., the thin wire &lt;&lt; 1 mm). In order to decrease the computational effort required by the model, in many of the numerical studies, the birdcage coil is simplified with respect to its actual structure. In some investigations (112, 113), the birdcage coil is modeled removing all the lumped elements: the capacitors are replaced by current generators, with sinusoidal time behavior (i.e., at the frequency of 64 or 128 MHz) and a phase delay equal to the azimuthal angle in order to obtain circular polarization. In this case, the resonance mode is no longer achieved by tuning the capacitors, but by forcing the right current distribution inside the birdcage coil. This model is able to faithfully reproduce the electromagnetic field distribution of an unloaded birdcage coil, but, when adopted to simulate the interaction with an implanted device in the body, it becomes much less accurate, in particular when the implant is placed immediately underneath the skin (e.g., an implanted infusion pump), close to the transmit RF coil.</para>
    <para>As already highlighted in the previous section, FDTD and related methods remain dominant in numerical field calculations that consider realistic human body models. However, it is not the ideal method in all situations, such as when dealing with fields near highly conductive surfaces in any arbitrary orientation, as with most RF coils. Generally, FDTD and related methods rely on a Cartesian grid (with regular or irregular grid spacing), so surfaces at oblique angles are represented in a 'staircase' fashion. Although there are some algorithms to help reduce the shortcomings of FDTD-type methods in these situations, other approaches include development of human body models for finite element methods (114) and hybrid approaches using one numerical method in regions containing the RF coils, and another in the region containing the human body are often adopted (115).</para>
    <para>Modeling has also been applied to investigate the interactions between implants and the time-varying gradient magnetic fields. The gradient coils of an MR system generate time varying magnetic fields with a frequency in the kHz range. These varying magnetic fields generate induced electric fields on implanted metallic devices during the MRI process that results in the appearance of eddy currents which can generate induced voltages on the electronics of active implanted medical devices. In the frequency range of gradient fields, capacitive and electromagnetic propagation can be neglected, thus, it is possible to treat bioelectric currents and voltages in living tissues as stationary. This is known as the quasi-static approximation. Under quasi-static assumptions, the stimulus amplitude and the resulting voltage, electric field and current density are all in a linear relationship. Therefore, it is sufficient to employ a steady-state solver, which greatly simplifies the computational costs of the analysis required.</para>
    <para>As for the static magnetic field, modeling and simulations were mainly adopted to address the problem of the disturbance of the static field owing to the presence of a metallic implant in the patient, resulting in imaging artifacts which may impact the diagnostic use of MRI, sometimes making it difficult or even impossible to interpret the images. To consider the implementation of correction techniques or magnetic susceptibility artifacts attenuation, it is essential to be able to calculate very accurately the disturbance of the local magnetic field generated by the implanted metallic object placed in MRI conditions. For this purpose, analytical models may be useful tools to perform design and optimization studies on metallic objects with simple geometries (116). For more complex geometries, however, an accurate computation of the local magnetic field is needed, using numerical</para>
        </sect2>
      </sect1>
      <sect1 id="ch0023s0000s0005">
        <title>The Role of Numerical Modeling and Simulations</title>
    <para>methods such as FEM. These numerical methods enable the modeling of magnetic field deformations in the diamagnetic and paramagnetic samples environment and they can be validated for simple implant geometries (117).</para>
        <sect2 id="ch0023s0000s0005s0001">
          <title>The Model of the Human Body</title>
    <para>The success of computational modeling is due to the possibility of performing systematic analyses of the several variables affecting the interactions between the patient with a metallic implant and the MR system, with reduced costs and increased reproducibility compared to experimental measurements. If there are fundamental flaws or inaccuracies in the model that mask or modify the physics under examination, even if the simulation itself runs flawlessly, results might be erroneous and predictions based on that simulation will not accurately embody the intended aspects of the physical world. It is with this motivation in mind that developers of phantoms characterizing the human body and its corresponding physiological processes have continuously advanced the state-of-the-art and pursued ever more accurate representations of human anatomy at a variety of geometric scales.</para>
    <para>Many MRI simulations that evaluated the safety of implanted devices, in particular the early studies conducted when the computational resources were still limited to account for the detailed representation of the human tissues, adopted numerical models of the body that were derived from the physical phantoms used in experimental studies. Physical phantoms are typically made of solid materials, which are approximately equivalent to human tissues in terms of electromagnetic properties. They can be based on simplified designs or they can be anthropomorphic phantoms.</para>
    <para>Simplified phantoms have the advantage of being easily standardized. In the peer-reviewed literature, it is possible to find simplified phantoms made of different geometries such as: "oblong saline bath to simulate an endovascular intervention" (118), cylindrical phantom (119, 120), or spherical phantom (121). Because of their simplicity, simplified physical phantoms were also standardized. In the context of MRI exposures, the standardized phantom to assess MRI-related heating for a metallic implant is the American Society for Testing and Materials (ASTM) International phantom. In the first version of the standard, the phantom had a shape based on simplified human head and trunk regions (<emphasis role="bold">Figure 3a</emphasis>). In the 2011 edition of the standard (122), the phantom was revised to include only the trunk, suggesting a rectangular box shape (<emphasis role="bold">Figure 3b</emphasis>). The ASTM phantom of the standard is a container filled with a gelled-saline phantom material with electrical and thermal properties in the same range of the ones of the human body at the frequencies of interest (i.e., 64 to 128 MHz corresponding to 1.5 and 3 Tesla, respectively).</para>
    <para>An additional phantom proposed for controlled exposure conditions is the ellipsoidal phantom, described in the Annex M-3 of the Technical Specification (TS), International Organization for Standardization (ISO), ISO/TS 10974:2018 (123) (<emphasis role="bold">Figure 3c</emphasis>). In addition to simplified phantoms, anthropomorphic phantoms have been also implemented for a more realistic representation of the human body heterogeneity. These phantoms typically consist of several tissue-equivalent materials that are molded into shapes of organs or bones to represent single part or all of the human body. Among all, the bottle manikin absorption (BOMAB) phantom represents the ICRP reference man and it consists of 10 high-density polyethylene containers (124). Each of these phantoms are representative of body sections,</para>
    <para>MRI Bioeffects, Safety, and Patient Management     631</para>
    <para><emphasis role="bold">Figure 3.</emphasis> ASTM phantoms (a) first edition and (b) second edition indicated in the ASTM F2182 standard (122). (c) Ellipsoidal phantom suggested in ISO/TS 10974:2018 (123).</para>
  <figure>
    <title/>
    <mediaobject>
      <imageobject>
        <imagedata fileref="Ch0005f10.jpg" width="100%" scalefit="1"/>
      </imageobject>
    </mediaobject>
  </figure>
    <para>such as the head phantom and human torso (125). However, even the most complex physical phantom cannot adequately represent the extremely complex morphological properties of the actual human body. On the other hand, numerical modeling allows for a much more realistic representation.</para>
    <para>Currently, several voxel and surface human body models are available for downloading free of charge for non-commercial use. Among these, the most often used solution adopted not only for electromagnetic exposure evaluations but also in many other medical applications where the detailed human anatomy has to be reproduced, is the Virtual Family (VF) (100).</para>
    <para>The VF is a set of four highly detailed, anatomically correct, whole-body models of an adult male, an adult female, and two children. The four models are based on high-resolution (MRI data of healthy volunteers. Organs and tissues of the models are represented by three-dimensional, highly detailed computer-aided design (CAD) objects without self-intersections and gaps. The CAD objects allow the models to be meshed at arbitrary resolutions without loss of small features. As of the end of 2014, the VF was used in more than 120 medical device submissions to the Food and Drug Administration (FDA) and was cited more than 180 times in the peer-reviewed literature. The following two VF model versions are available free of charge:</para>
    <itemizedlist>
      <listitem><para>VF 1.0: The VF 1.0 models include segmentation of approximately 80 high-resolution organs and tissues. The Virtual Family Tool can be used to discretize and export the CAD objects in a generic voxel-based format. All four VF 1.0 models and the Virtual Family Tool are provided free of charge (except for shipping and handling fees) to the scientific community for academic purposes, only.</para>
      </listitem>
      <listitem><para>VF 2.0: The VF 2.0 models consist of simplified CAD files optimized for finite-element modeling in any third-party platform. These models are based on a new, high-end generation of VF models that have been re-segmented at finer resolution to afford a higher degree of precision and anatomical refinement, as well as improved structural continuity of approximately 300 organs and tissues. For the purpose of simplification, these structures are combined into 22 high-resolution tissues. The VF 2.0 models are available free of charge (except for shipping and handling fees) to everyone.</para>
      </listitem>
    </itemizedlist>
        </sect2>
      </sect1>
      <sect1 id="ch0023s0000s0006">
        <title>The Role of Numerical Modeling and Simulations</title>
<table frame="all">
  <title/>
  <tgroup cols="6">
    <colspec colname="c1"/>
    <colspec colname="c2"/>
    <colspec colname="c3"/>
    <colspec colname="c4"/>
    <colspec colname="c5"/>
    <colspec colname="c6"/>
    <thead>
      <row>
        <entry>Name</entry>
        <entry>Sex</entry>
        <entry>Age (years)</entry>
        <entry>Height (m)</entry>
        <entry>Weight (kg)</entry>
        <entry>BMI (kg/m2)</entry>
      </row>
    </thead>
    <tbody>
      <row>
        <entry>Duke</entry>
        <entry>Male</entry>
        <entry>34</entry>
        <entry>1.77</entry>
        <entry>70.3</entry>
        <entry>22.4</entry>
      </row>
      <row>
        <entry>Ella</entry>
        <entry>Female</entry>
        <entry>26</entry>
        <entry>1.63</entry>
        <entry>57.3</entry>
        <entry>21.5</entry>
      </row>
      <row>
        <entry>Billie</entry>
        <entry>Female</entry>
        <entry>11</entry>
        <entry>1.49</entry>
        <entry>34.0</entry>
        <entry>15.4</entry>
      </row>
      <row>
        <entry>Thelonius</entry>
        <entry>Male</entry>
        <entry>6</entry>
        <entry>1.15</entry>
        <entry>18.6</entry>
        <entry>14.1</entry>
      </row>
    </tbody>
  </tgroup>
</table>
    <para>(BMI, Body Mass Index)</para>
    <para><emphasis role="bold">Table 1</emphasis> summarizes the main characteristics of the four models of the VF.</para>
    <para>In the VF models, individual tissues are composed of large numbers of triangles, and the whole-body triangle count ranges between 3.6 to 7.7 million. The models are distributed as surface meshes in STL (i.e., Standard Tessellation Language or STereoLithography) format. Each tissue is stored as a separate surface mesh, which is guaranteed to be closed, but may contain non-manifold edges or vertices.</para>
    <para>In addition to the initial human body models, the VF has been then extended to increase the population coverage: the MR images of additional child volunteers (five and eight year old girls, and five and 14 year old boys) were segmented to create the Virtual Classroom. Increased coverage of anatomical variability was provided with obese (37 years old, 1.82 m, 120 kg) and elderly (84 years old, 1.73 m, 65 kg) male models, an eight week old baby model, and three pregnant women models at gestational stages of three, seven and nine months. Today, this widely used set of anatomical models is also known as the Virtual Population (ViP) (<emphasis role="bold">Figure 4</emphasis>).</para>
    <para>The ViP 1.0 has been applied in a large variety of exposure studies, such as those involving mobile phones, wireless devices, MR systems, home appliances, and safety and efficacy assessments of medical treatments (e.g., hyperthermia therapy), implant safety,</para>
    <para><emphasis role="bold">Figure 4.</emphasis> Virtual Population voxel models (100, 101).</para>
  <para>product development and optimization, and basic research, including mechanistic investigations).</para>
    <para>However, while they have been employed in selected cases to the assessment of medical devices and therapies (e.g., the safety of implants during MRI), the first generation of the Virtual Population suffers from limitations related to limited local detail and accuracy, unsuitable tissue surface quality, missing fine structures and insufficient fine structure continuity, as well as inconsistent segmentation across the different models. Furthermore, current devices often combine complex interactions from multiple domains of physics and physiology sometimes in a coupled manner, which require models adapted to different solvers (e.g., a finite-element method, FEM), which typically requires high-quality unstructured meshes. In order to overcome these, a second generation of VF models (ViP3) was developed, reaching a level of detail and accuracy with more than 300 tissues and organs per model and a resolution of 0.5 × 0.5 × 0.5 mm³ throughout the entire body. For these new-generation models, posing functionalities are available to parameterize the posture of the models. In addition, to further extend the population coverage, morphing functionality is also provided that allows, for example, the fat or muscle content to be increased or decreased to change the body-mass index (BMI) of the models while preserving realistic internal organ placement and tissue distributions.</para>
    <para>The Virtual Population 3.0 models are integrated within the multiphysics simulation platform, Sim4Life, which includes only a time domain electromagnetic solver, or the SEMCAD time domain electromagnetic solver. The Virtual Population 3.0 models cannot be exported to any third-party software. The Virtual Family v1.x models are also compatible with Sim4Life or SEMCAD time domain electromagnetic solvers, or can be exported to other solvers only in voxel format, which is not suitable for import into solvers based on unstructured meshes.</para>
    <para>Recent literature includes reports of the development of surface-based models obtained from the conversion of voxel-based data, and then used for electromagnetic simulation with solvers that need unstructured meshes (e.g., FEM), which could be more efficient in modeling in the frequency domain than other elements of the complete model, that is, the transmit RF coil and the implant. However, converting to high-quality, surface-based objects and correctly matching contact regions is not trivial and presents a significant challenge. Thus, only a few surface-based, full-body human models are available today, providing levels of detail of different human tissues that are not always adequate to be used as a realistic human model in MRI simulations for the assessment of the safety of implanted leads. However, these models have the advantage that can be obtained from the voxel models derived from the Visual Human Project Visible Man and Visible Woman data sets, which have formed the basis for a large number of MRI safety assessments (126). For inter-laboratory studies, in general, it is beneficial to use voxel- and surface-based models derived from the same dataset.</para>
    <para>The anatomic accuracy of the human body model is not the only key element that guarantees the success of a numerical analysis. Depending on the physics to be applied in the simulation, the parameters of interest (e.g., electric and magnetic conductivity, permittivity and permeability for electromagnetic simulations, or thermal conductivity, heat generation</para>
    <para>rate, heat transfer rate or perfusion, and heat capacity for thermal simulations) must be assigned to the different tissues. Such parameters can be derived from the studies available in literature that specifically investigated the properties of human tissues in the different frequency ranges (127) or from the databases available on-line (128) that, based on a comprehensive review of the aforementioned scientific papers, provide the modeling community with average and range-of-variation values of electromagnetic and thermal properties, as well as density and perfusion of biological tissues, as a function of the frequency of interest.</para>
    <para><emphasis role="bold">The Model of the Implant</emphasis>The model of the lead represents the most critical aspect for MRI simulations that evaluates the safety of this implant. As such, it needs, at a minimum, a sub-millimeter discretization inside the comparatively large volume of the transmit body RF coil of the MR system and must account for a vast selection of realistic implant positions in numerous human body models in order to perform a statistical basis for a prediction of the expected worst-case condition. In addition, the inner structure of the lead is often difficult to be known in sufficient detail because each device manufacturer may adopt proprietary solutions that are rarely accessible by the general public. For these reasons, many MRI simulations directed toward comparing different exposure conditions (e.g., in terms of implant positioning inside the human body, the level of RF energy applied during MRI, the position of the body inside the transmit RF coil, etc.) or different implant basic characteristics (e.g., lead length, thickness of the insulation sheet, etc.), adopted as the implant model a simple insulated metallic wire with exposed conductive tips. It is obvious that such a simplified model does not produce realistic results and, thus, is not suitable to predict what can be expected during a "real" MRI examination involving a patient with actual implanted leads.</para>
    <para>Typical leads used in implanted devices (e.g., cardiac pacemakers, implanted cardioverter defibrillators, neurostimulation systems, etc.) use coiled wire configurations. The coiling of the wire is essentially utilized to increase the flexibility and implanted lifetime of the lead. Coiled wires used in such devices may be single filar (single strand of wire) or have multi-filar windings (i.e., there may be more than one conductive strand coiled together to form the wire form). Such complex structures, arranged over realistic pathways compatible with the anatomy of the human body cannot be easily represented in the FDTD environment. Other techniques, such as the MoM, are more favorable, but then suffer from the already mentioned limitations, when the model of the implant has to be integrated inside an accurate model of the human body.</para>
    <para>Studies that reproduced and investigated lead structures more complex than the simple insulated wire mainly focused on developing and comparing the performance of implanted lead designs or strategies that could eliminate or ameliorate the hazards related to MRI (129, 130). Whereas these studies achieved a substantial significance with respect to the design of the MR Conditional implants, they were not suitable for adoption as an accurate implant model in the complete model of interactions between the MR scanner and the patient. The difficulties to numerically solve human and lead models simultaneously due to the complex structure of implanted lead systems prompted the researchers to find an alternative approach,</para>
    <para>based on the concept that it may be advantageous to model the lead and the human separately and then combine the results to determine the heating.</para>
    <para>In 2007 Park, et al. (131), introduced the concept the transfer function (TF) of a lead, that is a mathematical function that relates the incident electric field to the scattered electric field in the vicinity of the electrode. From knowledge of the TF, the heating at the lead's electrode and the resonant behavior of leads in phantom and human models can be predicted.</para>
    <para>The TF concept comes directly from the formulation of the electromagnetic problem by the Method of Moments (MoM): the scattered field at the lead tip is considered to be the linear superposition of the effect of the tangential incident field all along the lead. Different methodologies have been proposed to measure the TF of an implanted lead.</para>
    <para>Park, et al. (131) calculated the transfer function for simple wire geometries that simulated implanted leads using the MoM technique. First, the scattered electric field at a test point near the lead tip arising from a uniform incident electric field of 1 V/m was computed. Then, the radial component of scattered electric field at the same test point, P, was calculated for a step function of the tangential E-field that has unit value (1 V/m) over a specific segment of the lead and is zero over the remainder of the lead. The TF is finally obtained from these two contribute to the scattered electric field, considering the power dissipation around the lead tip as the linear superposition of the contribute obtained by the moving the step function of the tangential E-field all along the lead length.</para>
    <para>By definition, the FT depends on the electrical properties of the surrounding tissue, the RF frequency, and on the structure and characteristics of the lead under test. Therefore, it is assumed to be independent from the particular lead path adopted. Thus, the electric field at the tip of the lead, placed in any possible configuration inside the human body model, can be easily estimated from the E-field distribution computed inside the body without the implant.</para>
    <para>Even if such an approach allows the ability to "decouple" the model of the implanted lead and of the human body, the estimation of the TF obtained from numerical calculations is still rather demanding, since the actual detailed model of the lead has to be known and reproduced. The TF can be calculated also via experimental measurements, by exciting a small portion of the lead with an electric field that needs to be constant over the small section measured and then drastically reduced to zero in the nearby sections. The TF is then obtained by recording the E-field at the tip, while moving the excitation signal all along the lead. However, the generation of such an excitation signal is not immediate and requires specific and rather expensive systems (131, 132).</para>
    <para>Due to the aforementioned limitations, alternative methods have been proposed in the peer-reviewed literature (133, 134). An interesting alternative approach is based on the reciprocity principle conjugated with the Huygens' principle (i.e., this principal shows how a wave field on a surface determines the wave field outside the surface) and demonstrates that, if one excites the electrode where the heating has to be evaluated, the current distribution along the lead is actually the transfer function. Thus, the current distribution can be obtained numerically, by exciting the lead with a known current source at the tip, or exper-</para>
    <para>imentally, by injecting an RF signal (64 MHz or 128 MHz corresponding to 1.5 Tesla or 3 Tesla, respectively) into the lead and measuring the current along the lead itself. In the latter case, in order to obtain from the resulting current distribution a transfer function for the heating evaluation, a calibration factor has to be determined experimentally, by performing heating measurements under a known incident electric field.</para>
    <para>Currently, the TF is widely adopted, not only for research purposes, but also by device manufacturers, in the design phase to test the safety of their products, and to produce evidence of the safety for the regulatory body in charge of issuing the marketing authorization. The TF is also described as one of the four-tiered approaches described in the Technical Standard (TS) from the International Organization for Standards, ISO/TS 10974:2018 (123), which will be discussed in detail in one of the following sections.</para>
    <para><emphasis role="bold">Model Verification, Validation, and Uncertainty Quantification</emphasis></para>
    <para>Although performing a numerical analysis has numerous benefits, experimental validation of the numerical model remains a complementary and fundamental step to determine the degree to which a model is an accurate representation of the real world from the perspective of the intended use of the model. Verification, Validation, and Uncertainty Quantification (VVUQ) is a complex set of procedures for the assessment of the overall quality of the physical system results that are obtained with numerical simulations. The process of determining the accuracy with which a computational model can produce results deliverable by the physical system on which it is based is a development process that follows several steps.</para>
    <para>The flowchart presented in <emphasis role="bold">Figure 5</emphasis> from the American Society of Mechanical Engineers (ASME) guide on Standard for Verification and Validation in Computational Solid Mechanics (135) is a good outline of all the necessary steps that are required in the VVUQ process. The VVUQ can be essentially divided into three fundamental steps: (1) the verification of the numerical code implemented (2) the validation of the numerical results with experimental measurements, and (3) the quantification of the uncertainty of both numerical and experimental results. In accordance with this guidance from the ASME, these steps can be defined as:</para>
    <itemizedlist>
      <listitem><para>Verification: The process of determining that a computational model accurately represents the underlying mathematical model and its solution from the perspective of the intended uses of modeling and simulation.</para>
      </listitem>
      <listitem><para>Validation: The process of determining the degree to which a model or a simulation is an accurate representation of the real world from the perspective of the intended uses of the model or the simulation.</para>
      </listitem>
      <listitem><para>Uncertainty Quantification: The estimated amount or percentage by which an observed or calculated value may differ from the true value.</para>
      </listitem>
    </itemizedlist>
    <para>Ultimately, the numerical outcomes can be considered a good representation of the reality if the data are within the combined uncertainty of the numerical and experimental results. However, it is important to understand that a numerical code can never be fully verified for any conditions, but every code is verified against a set of numerical tests for the specific physical system of interest.</para>
      </sect1>
    </chapter>
